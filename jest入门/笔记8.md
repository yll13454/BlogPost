### 异步代码测试 

#### 要测试的代码

![image-20210122132213847](D:\笔记\jest入门\media\image-20210122132213847.png)

#### 测试用例步骤

创建文件夹_ _mocks__文件夹，里面存放要模拟的方法，数据。

测试刚开始的时候，首先会在mocks文件夹下面找是否有对应 的数据，有就会替换掉你所需要的数据。

![image-20210122133353037](D:\笔记\jest入门\media\image-20210122133353037.png)

用nextTick()来等待数据的获得并渲染

测试用例

![image-20210122133736427](D:\笔记\jest入门\media\image-20210122133736427.png)

- 当延时器包裹异步请求时

![image-20210122134331104](D:\笔记\jest入门\media\image-20210122134331104.png)

> jest异步最多不能超过5秒

![image-20210122134432919](D:\笔记\jest入门\media\image-20210122134432919.png)

![image-20210122134149608](D:\笔记\jest入门\media\image-20210122134149608.png)

jest异步测试在没有done函数执行时，是不回执行测试用例中延时器内部的代码部分，必须加上done()才会执行完整代码.

> 超时如果超过5秒

就用jest的timer模拟原生的timer=>jest.useFakeTimers()

需要在测试用例前头，初始化函数。 => jest.useFakeTimers()

1，一种方法

![image-20210122140958600](D:\笔记\jest入门\media\image-20210122140958600.png)

2，二种方法

因为是在全局开头初始化timer，可能会影响其他地方，执行timer的基数，所以要在每次测试前执行

![image-20210122143417128](D:\笔记\jest入门\media\image-20210122143417128.png)

![image-20210122143437120](D:\笔记\jest入门\media\image-20210122143437120.png)

#### 请求失败

模拟接口变化

![image-20210122145104487](D:\笔记\jest入门\media\image-20210122145104487.png)

测试用例变化

![image-20210122144934773](D:\笔记\jest入门\media\image-20210122144934773.png)

### 路由页面代码组织

![image-20210122164254126](D:\笔记\jest入门\media\image-20210122164254126.png)

路由的使用

安装

```
npm install vue-router --save
```

main.js引入并使用

![image-20210122164757313](D:\笔记\jest入门\media\image-20210122164757313.png) ![image-20210122164931305](D:\笔记\jest入门\media\image-20210122164931305.png) 