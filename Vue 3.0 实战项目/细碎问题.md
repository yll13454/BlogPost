### setup

- åœ¨ä»¥ä¸‹æ–¹æ³•å‰æ‰§è¡Œï¼š

- - Components
  - Props
  - Data
  - Methods
  - Computed Properties
  - Lifecycle methods

- å¯ä»¥ä¸åœ¨ä½¿ç”¨éš¾äºç†è§£çš„this
- æœ‰ä¸¤ä¸ªå¯é€‰å‚æ•°

- - props - å±æ€§ (å“åº”å¼å¯¹è±¡ ä¸” å¯ä»¥ç›‘å¬(watch))

    ```js
    import {watch} from "vue"
    export defalut {
    	props: {
    		name: String
    	},
    	setup(props) {
    		watch(() => {
    			console.log(props.name)
    		})
    	}
    }
    ```

  - context ä¸Šä¸‹æ–‡å¯¹è±¡ - ç”¨äºä»£æ›¿ä»¥å‰çš„thisæ–¹æ³•å¯ä»¥è®¿é—®çš„å±æ€§

    ```js
    setup (props,context) {
      const {attrs,slots,parent,root,emit} = context
    }
    ```

### refæ˜¯ä»€ä¹ˆ

å¯¹åŸºæœ¬æ•°æ®ç±»å‹æ•°æ®è¿›è¡Œè£…ç®±æ“ä½œä½¿å¾—æˆä¸ºä¸€ä¸ªå“åº”å¼å¯¹è±¡ï¼Œå¯ä»¥è·Ÿè¸ªæ•°æ®å˜åŒ–ã€‚

### **Methods**

- ####  åŸºç¡€ç”¨æ³•

![img](media\1608623818242-e735d131-a179-4a3f-9285-d865392f0c4e.png) 

- #### è‡ªåŠ¨æ‹†è£…ç®±æ€»ç»“

![img](media\1607418795325-a94b6e48-529e-4848-a066-8adcc21b3605.png) 

>JS ï¼šéœ€è¦é€šè¿‡.valueè®¿é—®åŒ…è£…å¯¹è±¡
>
>æ¨¡æ¿:  è‡ªåŠ¨æ‹†ç®±

### Computed - è®¡ç®—å±æ€§

```vue
<template>
  <div>
    <div>Capacityï¼š {{ capacity }}</div>
    <p>Spases Left: {{ sapcesLeft }} out of {{ capacity }}</p>
    <button @click="increaseCapacity()">Increase Capacity</button>
  </div>
</template>
<script>
import { ref, computed, watch } from "vue";
export default {
  setup(props, context) {
    const capacity = ref(3);
    const attending = ref(["Tim", "Bob", "Joe"]);
    function increaseCapacity() {
      capacity.value++;
    }
    const sapcesLeft = computed(() => {
      return capacity.value - attending.value.length;
    });
    return { capacity, increaseCapacity, attending, sapcesLeft };
  },
};
</script>
```

### **Reactive - å“åº”å¼è¯­æ³•**

```js
const {
            reactive, // åˆ›å»ºå“åº”å¼æ•°æ®å¯¹è±¡
            ref, // åˆ›å»ºä¸€ä¸ªå“åº”å¼çš„æ•°æ®å¯¹è±¡
            toRefs, // å°†å“åº”å¼æ•°æ®å¯¹è±¡è½¬æ¢ä¸ºå•ä¸€å“åº”å¼å¯¹è±¡
            isRef, // åˆ¤æ–­æŸå€¼æ˜¯å¦æ˜¯å¼•ç”¨ç±»å‹
        } = Vue
```

å®ä¾‹

```js
export default {
  setup() {
    const event = reactive({
      capacity: 4,
      attending: ["Tim", "Bob", "Joe"],
      spaceLeft: computed(() => {
        return event.capacity - event.attending.length;
      }),
    });
    function increaseCapacity() {
      event.capacity++;
    }
    return { ...toRefs(event), increaseCapacity };
  },
};
```

### Modularizing - æ¨¡å—åŒ–

ä½¿ç”¨CompositionAPIçš„ä¸¤ä¸ªç†ç”±

- å¯ä»¥æŒ‰ç…§åŠŸèƒ½ç»„ç»‡ä»£ç 
  ![image](media\1607418878094-2ff2a9b3-ea24-4b8f-9359-27ffd0250203.png)
- ç»„ä»¶é—´åŠŸèƒ½ä»£ç å¤ç”¨

![image](media\1607418878095-04f135b2-e4f7-4a1b-9958-e31498797c89.png) 

![image](media\1607418878122-933a5468-59d1-4cd7-9eee-fa135c2405bf.png) 



## LifecycleHooks - ç”Ÿå‘½å‘¨æœŸé’©å­

| Vue2           | Vue3                |
| -------------- | ------------------- |
| âŒ beforeCreate | setup               |
| âŒ created      | setup               |
| beforeMount    | onBeforeMount       |
| mounted        | onMounted           |
| beforeUpdate   | onBeforeUpdate      |
| updated        | onUpdated           |
| beforeDestroy  | onBeforeUnmount     |
| destroyed      | onUnmounted         |
| errorCaptured  | onErrorCaptured     |
|                | ğŸ‰ onRenderTracked   |
|                | ğŸ‰ onRenderTriggered |

setupä¸­è°ƒç”¨ç”Ÿå‘½å‘¨æœŸé’©å­

```js
import { onBeforeMount,onMounted } from "vue";
export default {
  setup() {
    onBeforeMount(() => {
        console.log('Before Mount!')
    }) 
    onMounted(() => {
        console.log('Before Mount!')
    }) 
  },
};
```

### **Watch - ç›‘å¬å™¨**

```js
// æ‰€æœ‰ä¾èµ–å“åº”å¼å¯¹è±¡ç›‘å¬
watchEffect(() => {
   results.value = getEventCount(searchInput.value);
 });

// ç‰¹å®šå“åº”å¼å¯¹è±¡ç›‘å¬
watch(
  searchInput,
  () => {
    console.log("watch searchInput:");
  }
);

// ç‰¹å®šå“åº”å¼å¯¹è±¡ç›‘å¬ å¯ä»¥è·å–æ–°æ—§å€¼
watch(
  searchInput,
 (newVal, oldVal) => {
    console.log("watch searchInput:", newVal, oldVal);
  },
);

// å¤šå“åº”å¼å¯¹è±¡ç›‘å¬
watch(
  [firstName,lastName],
 ([newFirst,newLast], [oldFirst,oldlast]) => {
   // .....
  },
  
);

// éæ‡’åŠ è½½æ–¹å¼ç›‘å¬ å¯ä»¥è®¾ç½®åˆå§‹å€¼
watch(
  searchInput,
  (newVal, oldVal) => {
    console.log("watch searchInput:", newVal, oldVal);
  },
  {
    immediate: true, 
  }
);
```

### sharing State

### Suspense - æ‚¬å¿µ

### **Teleport - ä¼ é€é—¨**

#### 1. åŠŸèƒ½

ç±»ä¼¼Reactä¸­çš„Portal, å¯ä»¥å°†ç‰¹å®šçš„htmlæ¨¡æ¿ä¼ é€åˆ°Domçš„ä»»ä½•ä½ç½®

![img](media\1607418989462-3fad6570-f31f-4c04-9020-eec892e6dae1.png) 

#### 2. åŸºç¡€è¯­æ³•

é€šè¿‡é€‰æ‹©å™¨QuerySelectoré…ç½®

![img](media\1607418989429-4143bba8-c259-424d-8e68-6618515721f1.png) 

## Vueçš„è§†å›¾æ›´æ–°æµç¨‹

Dom => virtual DOM => render functions

åœ¨Vueä¸­æˆ‘ä»¬é€šè¿‡å°†è§†å›¾æ¨¡æ¿(template)ç¼–è¯‘ä¸ºæ¸²æŸ“å‡½æ•°(render function)å†è½¬åŒ–ä¸ºè™šæ‹ŸDom



template ä¸ renderåº”ç”¨åœºæ™¯åŒºåˆ«

- template - feature components ç‰¹æ€§åœºæ™¯

- - è§†å›¾
  - å¸ƒå±€ç»“æ„

- render - utility base components åŠŸèƒ½æ€§ç»„ä»¶

- - slot content æ’æ§½